{{ define "content" }}
<div class="clip-detail">
    <div class="clip-header">
        <div class="header-content">
            <h2>{{ .Clip.Title }}</h2>
            <div class="clip-badges">
                <span class="motion-badge {{ if .Clip.HasMotion }}motion{{ else }}no-motion{{ end }}">
                    {{ if .Clip.HasMotion }}Motion Detected{{ else }}No Motion{{ end }}
                </span>
            </div>
        </div>
        <a href="/clips" class="btn btn-secondary">&laquo; Back to Clips</a>
    </div>

    <div class="clip-content">
        <div class="video-section">
            <div class="video-container">
                <video controls autoplay width="100%" preload="metadata" poster="/clips/{{ .Clip.ID }}/thumbnail">
                    <source src="/clips/{{ .Clip.ID }}/video" type="{{ .Clip.VideoMimeType }}">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>

        <div class="clip-sidebar">
            <div class="metadata-card">
                <h3>Clip Information</h3>
                <div class="metadata-grid">
                    <div class="metadata-item">
                        <label>Client ID</label>
                        <span class="client-badge">{{ .Clip.ClientID }}</span>
                    </div>
                    <div class="metadata-item">
                        <label>Date</label>
                        <span id="clipDate" data-timestamp="{{ .Clip.TimeStamp }}">Loading...</span>
                    </div>
                    <div class="metadata-item">
                        <label>Time</label>
                        <span id="clipTime" data-timestamp="{{ .Clip.TimeStamp }}">Loading...</span>
                    </div>
                    <div class="metadata-item">
                        <label>Duration</label>
                        <span>{{ .Clip.Duration | formatDuration }}</span>
                    </div>
                </div>
            </div>

            <div class="metadata-card">
                <h3>Technical Details</h3>
                <div class="metadata-grid">
                    <div class="metadata-item">
                        <label>Resolution</label>
                        <span>{{ .Clip.VideoWidth }} Ã— {{ .Clip.VideoHeight }}</span>
                    </div>
                    <div class="metadata-item">
                        <label>Format</label>
                        <span class="format-badge">{{ .Clip.VideoMimeType }}</span>
                    </div>
                    <div class="metadata-item">
                        <label>File Size</label>
                        <span>{{ formatFileSize .Clip.VideoSize }}</span>
                    </div>
                </div>
            </div>

            <div class="metadata-card">
                <h3>Quick Actions</h3>
                <div class="action-buttons">
                    <a href="/clips/{{ .Clip.ID }}/download" class="btn btn-secondary">
                        <span>ðŸ“¥</span> Download Video
                    </a>
                    <button onclick="shareClip()" class="btn btn-secondary">
                        <span>ðŸ”—</span> Copy Link
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// Format and display local date/time for clip
function formatClipTimestamp() {
    const dateEl = document.getElementById('clipDate');
    const timeEl = document.getElementById('clipTime');
    if (!dateEl || !timeEl) return;
    const isoString = dateEl.getAttribute('data-timestamp');
    if (!isoString) return;
    const dateObj = new Date(isoString);
    // Format date: e.g., Monday, January 2, 2006
    const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
    // Format time: e.g., 15:04:05 MST
    const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', timeZoneName: 'short' };
    dateEl.textContent = dateObj.toLocaleDateString(undefined, dateOptions);
    timeEl.textContent = dateObj.toLocaleTimeString(undefined, timeOptions);
}
document.addEventListener('DOMContentLoaded', formatClipTimestamp);
function shareClip() {
    const url = window.location.href;
    if (navigator.clipboard) {
        navigator.clipboard.writeText(url).then(() => {
            // Simple feedback - you could enhance this with a toast notification
            const btn = event.target.closest('button');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<span>âœ“</span> Copied!';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
        });
    } else {
        // Fallback for older browsers
        const textarea = document.createElement('textarea');
        textarea.value = url;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
    }
}
</script>
{{ end }}
