{{ define "content" }}
<h2>Create New Client</h2>

{{ if .Client }}
<div class="form-container">
    <h3>Client Created Successfully</h3>
    <p><strong>ID:</strong> {{ .Client.ID }}</p>
    <div class="secret-display">
        <p><strong>Secret:</strong></p>
        <code>{{ .Secret }}</code>
        <p><small>Please save the secret. It will not be shown again.</small></p>
    </div>
    <a href="/clients" class="btn" style="margin-top: 1rem;">Back to Clients</a>
</div>
{{ else }}
<div class="form-container">
    {{ if .Error }}
    <p class="error">{{ .Error }}</p>
    {{ end }}
    <form action="/clients/new" method="post">
        <div class="settings-columns">
            <div class="settings-column">
                <h4>General</h4>
                <div class="form-group">
                    <label for="id">Client ID</label>
                    <input type="text" id="id" name="id" required>
                </div>
                <div class="form-group">
                    <label for="storage_limit">Storage Limit (MB)</label>
                    <input type="number" id="storage_limit" name="storage_limit" value="1024" required>
                </div>

                <h4>Recording</h4>
                <div class="form-group">
                    <label for="clip_duration">Clip Duration (seconds)</label>
                    <input type="number" id="clip_duration" name="clip_duration" value="60" required min="30" max="1800">
                </div>
                <div class="form-group">
                    <label for="capture_codec">Capture Codec</label>
                    <select id="capture_codec" name="capture_codec">
                        {{ range .SupportedCaptureCodecs }}
                        <option value="{{ . }}" {{ if eq . "MJPG" }}selected{{ end }}>{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
                <div class="form-group">
                    <label for="capture_frame_rate">Frame Rate (FPS)</label>
                    <input type="number" step="0.1" id="capture_frame_rate" name="capture_frame_rate" value="15.0">
                </div>
                <h4>Post-Processing</h4>
                <div class="form-group">
                    <label for="downscale_resolution">Downscale Resolution</label>
                    <select id="downscale_resolution" name="downscale_resolution">
                        {{ range .SupportedResolutions }}
                        <option value="{{ . }}">{{ if eq . "" }}None{{ else }}{{ . }}{{ end }}</option>
                        {{ end }}
                    </select>
                </div>
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="grayscale" name="grayscale">
                    <label for="grayscale">Grayscale</label>
                </div>
                <div class="form-group">
                    <label for="output_format">Output Format</label>
                    <select id="output_format" name="output_format">
                        {{ range .SupportedOutputFormats }}
                        <option value="{{ . }}" {{ if eq . "mp4" }}selected{{ end }}>{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
                <div class="form-group">
                    <label for="output_codec">Output Codec</label>
                    <select id="output_codec" name="output_codec">
                        {{ range .SupportedOutputCodecs }}
                        <option value="{{ . }}" {{ if eq . "libx264" }}selected{{ end }}>{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
                <div class="form-group">
                    <label for="video_bitrate">Video Bitrate</label>
                    <select id="video_bitrate" name="video_bitrate">
                        {{ range .SupportedVideoBitrates }}
                        <option value="{{ . }}" {{ if eq . "1000k" }}selected{{ end }}>{{ . }}</option>
                        {{ end }}
                    </select>
                </div>
            </div>
            <div class="settings-column">
                <h4>Motion Detection</h4>
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="motion_only" name="motion_only">
                    <label for="motion_only">Motion Only</label>
                </div>
                <div class="form-group">
                    <label for="motion_min_area">Min Area (square pixels)</label>
                    <input type="number" id="motion_min_area" name="motion_min_area" value="1000">
                </div>
                <div class="form-group">
                    <label for="motion_max_frames">Max Frames</label>
                    <input type="number" id="motion_max_frames" name="motion_max_frames" value="300">
                </div>
                <div class="form-group">
                    <label for="motion_warm_up_frames">Warm-Up Frames</label>
                    <input type="number" id="motion_warm_up_frames" name="motion_warm_up_frames" value="30">
                </div>
                <div class="form-group">
                    <label for="motion_min_width">Min Width (px)</label>
                    <input type="number" id="motion_min_width" name="motion_min_width" value="20">
                </div>
                <div class="form-group">
                    <label for="motion_min_height">Min Height (px)</label>
                    <input type="number" id="motion_min_height" name="motion_min_height" value="20">
                </div>
                <div class="form-group">
                    <label for="motion_min_aspect">Min Aspect Ratio</label>
                    <input type="number" step="0.01" id="motion_min_aspect" name="motion_min_aspect" value="0.3">
                </div>
                <div class="form-group">
                    <label for="motion_max_aspect">Max Aspect Ratio</label>
                    <input type="number" step="0.01" id="motion_max_aspect" name="motion_max_aspect" value="3.0">
                </div>
                <div class="form-group">
                    <label for="motion_mog_history">MOG2 History</label>
                    <input type="number" id="motion_mog_history" name="motion_mog_history" value="500">
                </div>
                <div class="form-group">
                    <label for="motion_mog_var_thresh">MOG2 Var Threshold</label>
                    <input type="number" step="0.01" id="motion_mog_var_thresh" name="motion_mog_var_thresh" value="16.0">
                </div>
            </div>
        </div>

        <button type="submit" class="btn">Create Client</button>
    </form>
</div>
{{ end }}
{{ end }}
